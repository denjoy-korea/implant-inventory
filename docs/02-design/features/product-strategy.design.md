# Design: DenJOY PMF ê°€ì†í™” í•µì‹¬ ê¸°ëŠ¥ ì„¤ê³„

> **ì°¸ì¡° í”Œëœ**: `docs/01-plan/features/product-strategy.plan.md`
>
> ë¹„ì¦ˆë‹ˆìŠ¤ ì „ëµ Planì—ì„œ ë„ì¶œëœ P0 ìš°ì„ ìˆœìœ„ ê³¼ì œ 4ê°€ì§€ë¥¼
> êµ¬ì²´ì ì¸ êµ¬í˜„ ì„¤ê³„ë¡œ ë³€í™˜í•œë‹¤.
>
> **P0 ê³¼ì œ ëª©ë¡**:
> 1. ê²°ì œ ìë™í™” (Toss Payments PG ì—°ë™)
> 2. ì˜¨ë³´ë”© ìœ„ìë“œ (ê¸°ì´ˆì¬ê³  í…œí”Œë¦¿ + ë‹¨ê³„ë³„ ê°€ì´ë“œ)
> 3. Free â†’ Paid ì „í™˜ ë„›ì§€ ì‹œìŠ¤í…œ

---

## 1. ê²°ì œ í”Œë¡œìš° â€” ê³„ì¢Œì´ì²´ + ì„¸ê¸ˆê³„ì‚°ì„œ (í˜„í–‰ ìœ ì§€)

### 1.1 í˜„í–‰ í”Œë¡œìš° (ìœ ì§€)

```
ê³ ê° í”Œëœ ì„ íƒ
  â†’ billing_history(pending) ìƒì„±
  â†’ Make.com Webhook â†’ ìš´ì˜ì ì•Œë¦¼ (ì¹´ì¹´ì˜¤í†¡/ì´ë©”ì¼)
  â†’ ìš´ì˜ì: ê³„ì¢Œ ì…ê¸ˆ í™•ì¸
  â†’ ìš´ì˜ì: í™ˆíƒìŠ¤ì—ì„œ ì„¸ê¸ˆê³„ì‚°ì„œ ì§ì ‘ ë°œí–‰
  â†’ ìš´ì˜ì: Supabaseì—ì„œ ìˆ˜ë™ìœ¼ë¡œ í”Œëœ í™œì„±í™”
```

**ìœ ì§€ ê·¼ê±°**: ì´ˆê¸° ìœ ë£Œ ê³ ê°ì´ ì†Œìˆ˜(< 15ê°œì†Œ)ì¸ ë™ì•ˆì€ ìˆ˜ë™ ì²˜ë¦¬ê°€ ë” íš¨ìœ¨ì .
Toss Payments PG ì—°ë™ì€ ìœ ë£Œ ê³ ê° 15ê°œì†Œ ì´ˆê³¼ ì‹œì ì— ê²€í† .

### 1.2 ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸ (ê²°ì œ ì²˜ë¦¬ SOP)

```
[ ] í”Œëœ ì‹ ì²­ ì•Œë¦¼ ìˆ˜ì‹  (Make.com â†’ ì¹´ì¹´ì˜¤í†¡)
[ ] ì…ê¸ˆ í™•ì¸ (ê³„ì¢Œ ì¡°íšŒ)
[ ] í™ˆíƒìŠ¤ â†’ ì „ìì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ (ê³µê¸‰ê°€ì•¡ / ë¶€ê°€ì„¸ 10% êµ¬ë¶„)
[ ] Supabase Dashboard â†’ hospitals í…Œì´ë¸” plan í•„ë“œ ìˆ˜ë™ ë³€ê²½
[ ] plan_expires_at ê°±ì‹  (ì›”ì •ê¸°: +1ê°œì›”, ì—°ê°„: +12ê°œì›”)
[ ] ê³ ê° ì´ë©”ì¼ ë°œì†¡ (í”Œëœ í™œì„±í™” ì•ˆë‚´)
```

### 1.3 VAT ì²˜ë¦¬ ê¸°ì¤€

| í•­ëª© | ë‚´ìš© |
|------|------|
| ê³¼ì„¸ ì—¬ë¶€ | ê³¼ì„¸ (SaaS ìš©ì—­) |
| ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ | í™ˆíƒìŠ¤ ì „ìì„¸ê¸ˆê³„ì‚°ì„œ |
| ë°œí–‰ ì‹œì  | ì…ê¸ˆ í™•ì¸ í›„ ë‹¹ì¼ |
| í‘œì‹œ ìš”ê¸ˆ | **VAT ë³„ë„** (ê³µê¸‰ê°€ì•¡) |
| ì‹¤ ì²­êµ¬ ê¸ˆì•¡ | í‘œì‹œ ìš”ê¸ˆ Ã— 1.1 |
| ë¶€ê°€ì„¸ | í‘œì‹œ ìš”ê¸ˆ Ã— 10% |

**ì‹¤ ì²­êµ¬ ê¸ˆì•¡ ì˜ˆì‹œ**:

| í”Œëœ | ê³µê¸‰ê°€ì•¡ | ë¶€ê°€ì„¸ | í•©ê³„ (ì‹¤ ë‚©ë¶€ì•¡) |
|------|---------|-------|----------------|
| Basic | â‚©29,000 | â‚©2,900 | **â‚©31,900** |
| Plus | â‚©69,000 | â‚©6,900 | **â‚©75,900** |
| Business | â‚©129,000 | â‚©12,900 | **â‚©141,900** |

> **ì£¼ì˜**: PricingPageì— "VAT ë³„ë„" ë¬¸êµ¬ê°€ ëª…í™•íˆ í‘œì‹œë˜ì–´ì•¼ ê³ ê° í˜¼ì„  ë°©ì§€ ê°€ëŠ¥.

### 1.4 P1 â€” Toss Payments PG ì—°ë™ (ìœ ë£Œ ê³ ê° 15ê°œì†Œ ì´í›„)

```
ì¡°ê±´: ì›” ê²°ì œ ì²˜ë¦¬ ê±´ìˆ˜ > 15ê±´ìœ¼ë¡œ ìˆ˜ë™ ìš´ì˜ ë¶€ë‹´ ë°œìƒ ì‹œ
íš¨ê³¼: ê²°ì œ ìë™í™”, ì•¼ê°„/ì£¼ë§ ì¦‰ì‹œ ì²˜ë¦¬, ìš´ì˜ì ê°œì… ì œê±°
êµ¬í˜„: @tosspayments/payment-sdk + Supabase Edge Function
ì†Œìš”: ì•½ 2ì£¼ (Toss ì‚¬ì—…ì ì‹¬ì‚¬ 1ì£¼ + ê°œë°œ 1ì£¼)
```

---

## 2. ì˜¨ë³´ë”© ìœ„ìë“œ â€” ì²« 10ë¶„ ë‚´ ê°€ì¹˜ ì²´í—˜ ì„¤ê³„

### 2.1 í˜„í™© ë¬¸ì œ

```
í˜„ì¬: ê°€ì… â†’ ë¹ˆ ëŒ€ì‹œë³´ë“œ (ì¬ê³  0ê±´, ìˆ˜ìˆ ê¸°ë¡ ì—†ìŒ)
ë¬¸ì œ: "ì–´ë””ì„œ ì‹œì‘í•˜ì§€?" â†’ ì´íƒˆ
ëª©í‘œ: 10ë¶„ ë‚´ "ì•„, ì´ê²Œ ìœ ìš©í•˜ë‹¤" ëŠë¼ê²Œ
```

### 2.2 ì˜¨ë³´ë”© ìœ„ìë“œ í”Œë¡œìš°

```
[Step 1] í™˜ì˜ í™”ë©´ + ì§„í–‰ í‘œì‹œ (30ì´ˆ)
    â†’ ë³‘ì›ëª… í™•ì¸, "3ë‹¨ê³„ë¡œ ì¤€ë¹„ë©ë‹ˆë‹¤" ì•ˆë‚´

[Step 2] ë¸Œëœë“œ í…œí”Œë¦¿ ì„ íƒ (2ë¶„)
    â†’ ì‚¬ìš© ì¤‘ì¸ ì„í”Œë€íŠ¸ ë¸Œëœë“œ ì²´í¬ë°•ìŠ¤
    â†’ Osstem / IBS / Dentium / Dio / Neobiotech / ê¸°íƒ€

[Step 3] ê¸°ì´ˆì¬ê³  ê°„í¸ ì…ë ¥ (5ë¶„)
    â†’ ì„ íƒ ë¸Œëœë“œì˜ ì£¼ìš” ê·œê²© ëª©ë¡ ìë™ í‘œì‹œ
    â†’ ê° ê·œê²©ë³„ í˜„ì¬ ì¬ê³  ìˆ˜ëŸ‰ë§Œ ì…ë ¥
    â†’ "ë‚˜ì¤‘ì— ìƒì„¸ ìˆ˜ì • ê°€ëŠ¥" ì•ˆë‚´

[Step 4] ìˆ˜ìˆ ê¸°ë¡ ì—…ë¡œë“œ ì•ˆë‚´ (2ë¶„)
    â†’ ë´íŠ¸ì›¹ ë‚´ë³´ë‚´ê¸° ë°©ë²• GIF ê°€ì´ë“œ
    â†’ ì—‘ì…€ ìƒ˜í”Œ ë‹¤ìš´ë¡œë“œ
    â†’ "ì§€ê¸ˆ ê±´ë„ˆë›°ê¸°" ì˜µì…˜ í¬í•¨

[Step 5] ì™„ë£Œ + ì²« ëŒ€ì‹œë³´ë“œ ì§„ì…
    â†’ "ì¬ê³  Nì¢… ë“±ë¡ ì™„ë£Œ!" ì„±ê³µ ë©”ì‹œì§€
    â†’ ëŒ€ì‹œë³´ë“œì—ì„œ ë¶€ì¡±ë¶„ í™•ì¸ ìœ ë„
```

### 2.3 ì‹ ê·œ ì»´í¬ë„ŒíŠ¸ ì„¤ê³„

#### íŒŒì¼ êµ¬ì¡°

```
components/
  OnboardingWizard.tsx         â† ë©”ì¸ ìœ„ìë“œ ì»¨í…Œì´ë„ˆ
  onboarding/
    Step1Welcome.tsx
    Step2BrandSelect.tsx
    Step3StockInput.tsx
    Step4UploadGuide.tsx
    Step5Complete.tsx
services/
  onboardingService.ts         â† ì˜¨ë³´ë”© ì§„í–‰ ìƒíƒœ ê´€ë¦¬
```

#### `OnboardingWizard.tsx` ì¸í„°í˜ì´ìŠ¤

```typescript
interface OnboardingWizardProps {
  hospitalId: string;
  hospitalName: string;
  plan: PlanType;
  onComplete: () => void;   // ìœ„ìë“œ ì™„ë£Œ â†’ ëŒ€ì‹œë³´ë“œ ì§„ì…
  onSkip: () => void;       // ì „ì²´ ê±´ë„ˆë›°ê¸°
}

// ì˜¨ë³´ë”© ì™„ë£Œ ì—¬ë¶€: hospitals í…Œì´ë¸”ì— onboarding_completed_at TIMESTAMPTZ ì»¬ëŸ¼ ì¶”ê°€
// ë˜ëŠ”: localStorage 'denjoy_onboarding_done_{hospitalId}' í”Œë˜ê·¸
```

#### `Step2BrandSelect.tsx` â€” ë¸Œëœë“œ í…œí”Œë¦¿

`fixtureReferenceBase.ts` ì‹¤ì œ ë°ì´í„° ê¸°ì¤€ìœ¼ë¡œ êµ¬í˜„. ì„¤ê³„ ì´ˆì•ˆ ëŒ€ë¹„ ë³€ê²½ ì‚¬í•­:

| í•­ëª© | ì„¤ê³„ ì´ˆì•ˆ | ì‹¤ì œ êµ¬í˜„ |
|------|---------|---------|
| IBS ë¸Œëœë“œëª… | Magicore C3 / Magicore S3 | IBS Implant (ë´íŠ¸ì›¹ ì‹¤ì œ ëª…ì¹­) |
| ì¶”ê°€ ë¸Œëœë“œ | â€” | ë©”ê°€ì  , Straumann, ë´í‹°ìŠ¤ ì¶”ê°€ |
| ì œí’ˆ ë¼ì¸ | OSSTEM 2ê°œ, Dentium 1ê°œ | OSSTEM 3ê°œ, Dentium 2ê°œ, DIO 2ê°œ ë“± í™•ì¥ |

**ìµœì¢… ë¸Œëœë“œ ëª©ë¡ (8ê°œ)**:
OSSTEM / IBS / Dentium / DIO / ë„¤ì˜¤ë°”ì´ì˜¤í… / ë©”ê°€ì   / Straumann / ë´í‹°ìŠ¤

```typescript
// UI: ì²´í¬ë°•ìŠ¤ ì¹´ë“œ ê·¸ë¦¬ë“œ (2ì—´)
// ì„ íƒëœ ë¸Œëœë“œì˜ ëª¨ë“  ê·œê²©ì„ Step3ì—ì„œ ìˆ˜ëŸ‰ ì…ë ¥
```

#### `onboardingService.ts` ì„¤ê³„

```typescript
export const onboardingService = {
  isCompleted: (hospitalId: string): boolean => {
    return !!localStorage.getItem(`denjoy_onboarding_done_${hospitalId}`);
  },

  markCompleted: (hospitalId: string): void => {
    localStorage.setItem(`denjoy_onboarding_done_${hospitalId}`, new Date().toISOString());
  },

  // ì„ íƒ ë¸Œëœë“œë¡œ ì¬ê³  í•­ëª© ì¼ê´„ ìƒì„±
  async createStockFromTemplate(
    hospitalId: string,
    items: { manufacturer: string; brand: string; size: string; quantity: number }[]
  ): Promise<number> {
    // inventoryService.bulkInsert() í™œìš©
  },
};
```

### 2.4 ì˜¨ë³´ë”© ìœ„ìë“œ ë…¸ì¶œ ì¡°ê±´

```typescript
// App.tsx â€” ëŒ€ì‹œë³´ë“œ ì§„ì… ì‹œ ì²´í¬
const shouldShowOnboarding =
  state.currentView === 'dashboard' &&
  state.user?.role === 'master' &&
  state.user?.status === 'active' &&
  !state.isLoading &&
  state.inventory.length === 0 &&
  !onboardingService.isCompleted(state.user?.hospitalId ?? '');
```

> **êµ¬í˜„ ê²°ì •**: ì˜¨ë³´ë”© ì™„ë£Œ ì—¬ë¶€ëŠ” `localStorage`ë¡œ ê´€ë¦¬ (`denjoy_onboarding_done_{hospitalId}` í‚¤).
> DB ì»¬ëŸ¼(`onboarding_completed_at`) ë°©ì‹ë³´ë‹¤ êµ¬í˜„ì´ ë‹¨ìˆœí•˜ë©° ì´ˆê¸° MVPì— ì í•©.
> ë©€í‹° ë””ë°”ì´ìŠ¤ ì§€ì›ì´ í•„ìš”í•´ì§€ëŠ” ì‹œì ì— DB ë§ˆì´ê·¸ë ˆì´ì…˜ ê²€í† .

### 2.5 UI/UX ìŠ¤í™

```
ë ˆì´ì•„ì›ƒ: ì „ì²´í™”ë©´ ëª¨ë‹¬ (z-[300])
ë°°ê²½: í°ìƒ‰, ì¤‘ì•™ ì¹´ë“œ (max-w-2xl)
ì§„í–‰: ìƒë‹¨ ìŠ¤í… ì¸ë””ì¼€ì´í„° (1â†’2â†’3â†’4â†’5 ë„íŠ¸)
ì• ë‹ˆë©”ì´ì…˜: ìŠ¤í… ì „í™˜ ì‹œ slide-in (x: 20 â†’ 0)
í•˜ë‹¨: "ì´ì „" + "ë‹¤ìŒ" ë²„íŠ¼, ìš°ì¸¡ ìƒë‹¨ "ê±´ë„ˆë›°ê¸°(X)"
ëª¨ë°”ì¼: í’€ìŠ¤í¬ë¦° ì²˜ë¦¬
```

---

## 3. Free â†’ Paid ì „í™˜ ë„›ì§€ ì‹œìŠ¤í…œ

### 3.1 ë„›ì§€ íŠ¸ë¦¬ê±° ì •ì˜

| íŠ¸ë¦¬ê±° | íƒ€ì´ë° | ë©”ì‹œì§€ |
|--------|--------|--------|
| **T1: ë°ì´í„° ë§Œë£Œ ì„ë°•** | ë§Œë£Œ 7ì¼ ì „ | "ìˆ˜ìˆ ê¸°ë¡ì´ 7ì¼ í›„ ì‚­ì œë©ë‹ˆë‹¤" |
| **T2: ê¸°ëŠ¥ í•œê³„ ë„ë‹¬** | ì¬ê³  90/100 í’ˆëª© | "ì¬ê³  í•œë„ 90% ë„ë‹¬, 10ê°œ ë‚¨ìŒ" |
| **T3: ì—…ë¡œë“œ íšŸìˆ˜ ì†Œì§„** | Free ì›” 1íšŒ ì´ˆê³¼ ì‹œë„ | "ì´ë²ˆ ë‹¬ ì—…ë¡œë“œ í•œë„ ì´ˆê³¼" |
| **T4: 14ì¼ ì²´í—˜ ë§Œë£Œ D-3** | ì²´í—˜ ë§Œë£Œ 3ì¼ ì „ | "ì²´í—˜ 3ì¼ ë‚¨ìŒ, ì—°ê°„ ê²°ì œ ì‹œ 20% í• ì¸" |
| **T5: ì²´í—˜ ë§Œë£Œ ë‹¹ì¼** | ë§Œë£Œ 0ì¼ | "ì˜¤ëŠ˜ ë§Œë£Œ. ì—°ê°„ ê²°ì œë¡œ ì „í™˜ ì‹œ 20% í• ì¸" |
| **T6: í™œì„± ì‚¬ìš© í›„ 14ì¼** | ë§ˆì§€ë§‰ ë¡œê·¸ì¸ 14ì¼ í›„ | ì¬ì°¸ì—¬ ìœ ë„ (ì´ë©”ì¼) |

### 3.2 ì¸ì•± ë„›ì§€ ì»´í¬ë„ŒíŠ¸ ì„¤ê³„

#### ì‹ ê·œ íŒŒì¼

```
components/
  UpgradeNudge.tsx         â† ìƒë‹¨ ìŠ¤í‹°í‚¤ ë°°ë„ˆ
  PlanLimitToast.tsx       â† í•œê³„ ë„ë‹¬ ì‹œ í† ìŠ¤íŠ¸
  TrialCountdown.tsx       â† í—¤ë” ë‚´ ì²´í—˜ ì¹´ìš´íŠ¸ë‹¤ìš´ (ê¸°ì¡´ ê°œì„ )
```

#### `UpgradeNudge.tsx` ë°°ë„ˆ ë””ìì¸

```
[UI ìŠ¤í™]
ìœ„ì¹˜: Sidebar ì•„ë˜, ëŒ€ì‹œë³´ë“œ ì½˜í…ì¸  ìƒë‹¨ (sticky)
ë†’ì´: 44px
ë°°ê²½: amber-50 (ê²½ê³ ) / rose-50 (ê¸´ê¸‰)
ë‚´ìš©: ì•„ì´ì½˜ + ë©”ì‹œì§€ í…ìŠ¤íŠ¸ + "ì—…ê·¸ë ˆì´ë“œ" CTA ë²„íŠ¼

ì˜ˆì‹œ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš  ìˆ˜ìˆ ê¸°ë¡ì´ 3ì¼ í›„ ì‚­ì œë©ë‹ˆë‹¤.  [ì§€ê¸ˆ ì—…ê·¸ë ˆì´ë“œ â†’] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ê¸´ê¸‰ (rose):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”´ ì²´í—˜ ì¢…ë£Œ. ë°ì´í„° ë³´ê´€ì„ ìœ„í•´ í”Œëœì„ ì„ íƒí•˜ì„¸ìš”. [ì„ íƒí•˜ê¸°] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### `UpgradeNudge.tsx` ì¸í„°í˜ì´ìŠ¤

```typescript
type NudgeType =
  | 'data_expiry_warning'   // T1: ë§Œë£Œ ì„ë°•
  | 'item_limit_warning'    // T2: ì¬ê³  í•œë„
  | 'upload_limit'          // T3: ì—…ë¡œë“œ ì´ˆê³¼
  | 'trial_ending'          // T4: ì²´í—˜ ë§Œë£Œ ì„ë°•
  | 'trial_expired'         // T5: ì²´í—˜ ë§Œë£Œ
  ;

interface UpgradeNudgeProps {
  type: NudgeType;
  daysLeft?: number;
  currentCount?: number;
  maxCount?: number;
  onUpgrade: () => void;
  onDismiss?: () => void;
}
```

### 3.3 ë„›ì§€ ë…¸ì¶œ ë¡œì§ (App.tsx í†µí•©)

```typescript
// App.tsx â€” useMemoë¡œ í˜„ì¬ ë„›ì§€ íƒ€ì… ê³„ì‚°
const activeNudge = useMemo<NudgeType | null>(() => {
  if (!planState || planState.plan !== 'free') return null;

  // T5: ì²´í—˜ ë§Œë£Œ
  if (planState.isTrialActive === false && planState.trialUsed) return 'trial_expired';

  // T4: ì²´í—˜ D-3
  if (planState.isTrialActive && (planState.trialDaysRemaining ?? 99) <= 3) return 'trial_ending';

  // T1: ë°ì´í„° ë§Œë£Œ D-7 (Free: 3ê°œì›”)
  if (planState.retentionDaysLeft !== undefined && planState.retentionDaysLeft <= 7) return 'data_expiry_warning';

  // T2: ì¬ê³  90% ì´ìƒ
  const itemRatio = inventory.length / PLAN_LIMITS.free.maxItems;
  if (itemRatio >= 0.9) return 'item_limit_warning';

  return null;
}, [planState, inventory]);
```

### 3.4 ì´ë©”ì¼ ì‹œí€€ìŠ¤ (Supabase Edge Function + Make.com)

| ì´ë©”ì¼ | ë°œì†¡ ì‹œì  | ì œëª© |
|--------|---------|------|
| E1. í™˜ì˜ | ê°€ì… ì¦‰ì‹œ | "ë´ì¡°ì´ ê°€ì…ì„ í™˜ì˜í•©ë‹ˆë‹¤ â€” ì‹œì‘ ê°€ì´ë“œ" |
| E2. 7ì¼ ì²´í¬ì¸ | ê°€ì… 7ì¼ í›„ | "ì¬ê³  ê´€ë¦¬ ì–´ë– ì„¸ìš”? íŒ 3ê°€ì§€ë¥¼ ë“œë ¤ìš”" |
| E3. ì²´í—˜ D-3 | ì²´í—˜ ë§Œë£Œ 3ì¼ ì „ | "ë¬´ë£Œ ì²´í—˜ 3ì¼ ë‚¨ìŒ â€” ì§€ê¸ˆ ì „í™˜í•˜ë©´ í˜œíƒ" |
| E4. ì²´í—˜ ë§Œë£Œ | ë§Œë£Œ ë‹¹ì¼ | "[ê¸´ê¸‰] ì˜¤ëŠ˜ ì²´í—˜ ì¢…ë£Œ â€” ë°ì´í„°ë¥¼ ì§€í‚¤ì„¸ìš”" |
| E5. ë°ì´í„° ë§Œë£Œ D-7 | ë³´ê´€ ë§Œë£Œ 7ì¼ ì „ | "ìˆ˜ìˆ ê¸°ë¡ Xê±´ì´ 7ì¼ í›„ ì‚­ì œë  ì˜ˆì •ì…ë‹ˆë‹¤" |

**ë°œì†¡ íŠ¸ë¦¬ê±°**: Supabase `pg_cron` ìŠ¤ì¼€ì¤„ëŸ¬ + Edge Function

```sql
-- ë§¤ì¼ ì˜¤ì „ 9ì‹œ ë§Œë£Œ ì˜ˆì • ë³‘ì› ê°ì§€
SELECT cron.schedule(
  'nudge-email-daily',
  '0 9 * * *',
  $$SELECT net.http_post(url := 'https://xxx.supabase.co/functions/v1/send-nudge-emails') $$
);
```

---

## 4. ë°ì´í„° ëª¨ë¸ ë³€ê²½ ìš”ì•½

### 4.1 ì‹ ê·œ ì»¬ëŸ¼

```sql
-- hospitals í…Œì´ë¸”
ALTER TABLE hospitals ADD COLUMN IF NOT EXISTS onboarding_completed_at TIMESTAMPTZ;

-- billing_history í…Œì´ë¸” (ê¸°ì¡´ í™•ì¸ í•„ìš”)
-- toss_payment_key VARCHAR (ê²°ì œ í‚¤ ë³´ê´€)
ALTER TABLE billing_history ADD COLUMN IF NOT EXISTS toss_payment_key VARCHAR;
```

### 4.2 ì‹ ê·œ Supabase Edge Functions

| Function | ì—­í•  |
|----------|------|
| `send-nudge-emails` | ì¼ì¼ ë„›ì§€ ì´ë©”ì¼ ë°œì†¡ |

### 4.3 ì‹ ê·œ í™˜ê²½ ë³€ìˆ˜

```env
RESEND_API_KEY=re_...                 # ì´ë©”ì¼ ë°œì†¡ (Resend ì¶”ì²œ)
```

---

## 5. êµ¬í˜„ ìš°ì„ ìˆœìœ„ ë° ì˜ì¡´ì„±

```
[P0 - ì¦‰ì‹œ]
ì˜¨ë³´ë”© ìœ„ìë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì½”ë“œë§Œ ë³€ê²½, ë¹ ë¥¸ í”¼ë“œë°± ê°€ëŠ¥
ë„›ì§€ ì‹œìŠ¤í…œ (ì¸ì•±) â”€â”€â”€â”€â”€â”€â”€â”€ ì „í™˜ìœ¨ ì§ê²°

[P0 - ìš´ì˜]
ê²°ì œ SOP ì •ë¦½ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ê³„ì¢Œì´ì²´ + í™ˆíƒìŠ¤ ì„¸ê¸ˆê³„ì‚°ì„œ ìˆ˜ë™ ì²˜ë¦¬

[P1 - ìœ ë£Œ 15ê°œì†Œ ì´ˆê³¼ ì‹œ]
Toss Payments PG ì—°ë™ â”€â”€â”€â”€â”€ ìë™ ê²°ì œ, ìš´ì˜ ë¶€ë‹´ í•´ì†Œ
ì´ë©”ì¼ ì‹œí€€ìŠ¤ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Resend API ì„¤ì • í›„
```

### 5.1 êµ¬í˜„ ìˆœì„œ ê¶Œì¥

```
Week 1: ì˜¨ë³´ë”© ìœ„ìë“œ (ì „í™˜ìœ¨ ê°œì„ , ì½”ë“œ ë³€ê²½ë§Œ)
Week 2: ì¸ì•± ë„›ì§€ ë°°ë„ˆ + Toast (ì²´í—˜ â†’ ìœ ë£Œ ì „í™˜ ìœ ë„)
Week 3~: ê³ ê° ë°˜ì‘ ë³´ë©° ì´ë©”ì¼ ì‹œí€€ìŠ¤ / Toss PG ê²€í† 
```

---

## 6. ì„±ê³µ ì§€í‘œ (Design KPI)

| ê¸°ëŠ¥ | ì§€í‘œ | ëª©í‘œ |
|------|------|------|
| ê²°ì œ ìë™í™” | ê²°ì œ ì™„ë£Œ ì†Œìš” ì‹œê°„ | < 2ë¶„ |
| ê²°ì œ ìë™í™” | ê²°ì œ ì„±ê³µë¥  | > 95% |
| ì˜¨ë³´ë”© ìœ„ìë“œ | Step 3 ì™„ë£Œìœ¨ | > 70% |
| ì˜¨ë³´ë”© ìœ„ìë“œ | 7ì¼ Retention (ìœ„ìë“œ ì™„ë£Œ ì½”í˜¸íŠ¸) | > 75% |
| ë„›ì§€ ì‹œìŠ¤í…œ | T4/T5 íŠ¸ë¦¬ê±° â†’ ì—…ê·¸ë ˆì´ë“œ ì „í™˜ìœ¨ | > 20% |

---

## 7. ë¦¬ìŠ¤í¬ ë° ì™„í™” ë°©ì•ˆ

| ë¦¬ìŠ¤í¬ | ì™„í™” ë°©ì•ˆ |
|--------|---------|
| ìˆ˜ë™ ê²°ì œ ì²˜ë¦¬ ëˆ„ë½ | Make.com ì•Œë¦¼ + ì²˜ë¦¬ SOP ë¬¸ì„œí™”, ì²´í¬ë¦¬ìŠ¤íŠ¸ ìš´ì˜ |
| ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ ì§€ì—° | ì…ê¸ˆ í™•ì¸ ë‹¹ì¼ ë°œí–‰ ì›ì¹™ ìˆ˜ë¦½ |
| ì˜¨ë³´ë”© ë¸Œëœë“œ í…œí”Œë¦¿ ì˜¤ë¥˜ | "í¸ì§‘ ê°€ëŠ¥" ì•ˆë‚´ ëª…í™•íˆ, ë‚˜ì¤‘ì— ìˆ˜ì • ê°€ëŠ¥ ê°•ì¡° |
| ì´ë©”ì¼ ìŠ¤íŒ¸ ë¶„ë¥˜ | Resend + ë„ë©”ì¸ SPF/DKIM/DMARC ì„¤ì • |

---

**Created**: 2026-02-22
**Feature**: product-strategy
**Phase**: Design
**Ref Plan**: `docs/01-plan/features/product-strategy.plan.md`
**Status**: Draft
